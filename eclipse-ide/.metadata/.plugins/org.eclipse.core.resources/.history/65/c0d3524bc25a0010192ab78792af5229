package com.tom.auth.monolithic.controller;

import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import com.tom.auth.monolithic.user.service.FeatureFlagService;

import lombok.RequiredArgsConstructor;

@RestController
@RequestMapping("/v1/admin/features")
@RequiredArgsConstructor
@PreAuthorize("hasRole('ADMIN')")
public class AdminFeatureController {

    private final FeatureFlagService featureFlagService;

    @PostMapping("/sign-in/disable")
    public ResponseEntity<String> disableSignIn() {
        featureFlagService.setSignInEnabled(false);
        return ResponseEntity.ok("Sign-in endpoint has been disabled.");
    }

    @PostMapping("/sign-in/enable")
    public ResponseEntity<String> enableSignIn() {
        featureFlagService.setSignInEnabled(true);
        return ResponseEntity.ok("Sign-in endpoint has been enabled.");
    }

    @GetMapping("/sign-in/status")
    public ResponseEntity<String> getSignInStatus() {
        boolean isEnabled = featureFlagService.isSignInEnabled();
        return ResponseEntity.ok("Sign-in endpoint is currently: " + (isEnabled ? "ENABLED" : "DISABLED"));
    }
    
    @PostMapping("/sign-up/disable")
    public ResponseEntity<String> disableSignUp() {
        featureFlagService.setSignUpEnabled(false);
        return ResponseEntity.ok("Sign-up endpoint has been disabled.");
    }

    @PostMapping("/sign-up/enable")
    public ResponseEntity<String> enableSignUp() {
        featureFlagService.setSignUpEnabled(true);
        return ResponseEntity.ok("Sign-up endpoint has been enabled.");
    }

    @GetMapping("/sign-up/status")
    public ResponseEntity<String> getSignUnStatus() {
        boolean isEnabled = featureFlagService.isSignUpEnabled();
        return ResponseEntity.ok("Sign-up endpoint is currently: " + (isEnabled ? "ENABLED" : "DISABLED"));
    }
    
}